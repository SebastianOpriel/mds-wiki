## Set-up the connector

### Changes in config.json

In the configuration file `resources/conf/config.json` <br>
a) set the **keystore** path to your p12. cerificate (DAPS Token) <br>
b) set the connector Id (Domain) and the connector accessURL <br>
`"ids:connectorDescription" : {`<br>
    `"@type" : "ids:BaseConnector",`<br>
    `"@id" : "https://MdsConnector2.test.mobility-dataspace.eu",`...<br>
and <br>
` "ids:accessURL" : {`<br>
        `"@id" : "https://MdsConnector2.test.mobility-dataspace.eu/api/ids/data" }`<br>

During interim operation, this information was not checked by DAPS. Now this field "referringConnector" will be checked **in the productive environment ** to increase system security. Please make sure that your connector domain for the productive environment is correct.

c) configure [another parameters](https://international-data-spaces-association.github.io/DataspaceConnector/Deployment/Configuration) if needed


### Changes in application.properties / setting environment variables

There are two ways to configure the DSC. Either by editing the _application.properties_ file directly or by setting the properties as environment variables. If you run the DSC as a Docker container you may prefer the latter option. When using environment variables, the properties are written in capital letters and dots are replaced by underscore. In the following sections both ways of configuration are shown.

To ensure traceability and auditability of transactions in the MDS, we require our participants to use the Clearing House on the productive stage). Only metadata (transaction ID, timestamp) are logged. Please make sure to set the logging in your connector accordingly.

#### Test Stage

In the configuration file `resources/application.properties` <br>

1. Set the attribute _clearing.house.url_<br>
`clearing.house.url= https://clearing.test.mobility-dataspace.eu/logs/messages/`

2. Set DAPS attributes:<br>
`daps.url=https://daps.test.mobility-dataspace.eu`<br>
`daps.token.url=https://daps.test.mobility-dataspace.eu/token`<br>
`daps.key.url=https://daps.test.mobility-dataspace.eu/jwks.json`<br>
`daps.incoming.dat.default.wellknown=/jwks.json`<br>
`daps.whitelisted.url=https://daps.test.mobility-dataspace.eu`<br>

Alternatively set the _environment variables_<br>

CLEARING_HOUSE_URL=https://clearing.test.mobility-dataspace.eu/logs/messages/<br>
DAPS_URL=https://daps.test.mobility-dataspace.eu<br>
DAPS_TOKEN_URL=https://daps.test.mobility-dataspace.eu/token<br>
DAPS_KEY_URL=https://daps.test.mobility-dataspace.eu/jwks.json<br>
DAPS_INCOMING_DAT_DEFAULT_WELLKNOWN=/jwks.json<br>
DAPS_WHITELISTED_URL=https://daps.test.mobility-dataspace.eu

#### Productive Stage

1. Set the attribute _clearing.house.url_<br>
`clearing.house.url= https://clearing.mobility-dataspace.eu/logs/messages/`

2. Set DAPS attributes:<br>
`daps.url=https://daps.mobility-dataspace.eu`<br>
`daps.token.url=https://daps.mobility-dataspace.eu/token`<br>
`daps.key.url=https://daps.mobility-dataspace.eu/jwks.json`<br>
`daps.incoming.dat.default.wellknown=/jwks.json`<br>
`daps.whitelisted.url=https://daps.mobility-dataspace.eu`<br>

Alternatively set the _environment variables_<br>

CLEARING_HOUSE_URL=https://clearing.mobility-dataspace.eu/logs/messages/<br>
DAPS_URL=https://daps.mobility-dataspace.eu<br>
DAPS_TOKEN_URL=https://daps.mobility-dataspace.eu/token<br>
DAPS_KEY_URL=https://daps.mobility-dataspace.eu/jwks.json<br>
DAPS_INCOMING_DAT_DEFAULT_WELLKNOWN=/jwks.json<br>
DAPS_WHITELISTED_URL=https://daps.mobility-dataspace.eu

### Deployment

Deploy and start the connector. If everything worked fine, the connector for the local build is available at `https://localhost:8080/` abd the Swagger UI at `https://localhost:8080/api/docs`
Please note, that the application uses Spring Security. Each endpoint behind /** needs a [user authentication](https://international-data-spaces-association.github.io/DataspaceConnector/Deployment/Configuration#authentication). 

## Set-up the MDS Frontend

Start the frontend `npm start`. 

If everything worked fine, the frontend for the local build is available at `https://localhost:8082/.` 

<img src="https://user-images.githubusercontent.com/91048868/169023128-e79a8770-0469-4264-9894-9ceed79deba8.jpg" width=600><br>

Using _Advanced View => Settings => General_ switch the connector deploy mode to **Productive**, then set the connector name, connector description, connector curator (as URL) and connector maintainer (as URL).
**Please be aware that this information is accurate and complete**. These fields represent the connector in the MDS catalog.<br>
Please note, that there is no logical link between the _Test mode_ of the Dataspace Connector and the Mobility Data Space _Test environment_. You need to use the **Productive mode** of the Dataspace Connector to work in the MDS **Test environment**.

<img src="https://user-images.githubusercontent.com/91048868/169081507-66ef0389-08ab-47ac-a240-4e588a9e6752.jpg" width=600>